<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <!-- Lock zoom/pan and fit notches on mobile -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover"
    />
    <title>Tea Shop Scenes</title>
    <link rel="stylesheet" href="styles.css" />

    <!-- p5.js + p5.sound -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js"></script>

    <script src="sketch.js" defer></script>
  </head>
  <body>
    <div id="sketch"></div>

    <!-- Controls (bottom-center) -->
    <div class="controls">
      <button id="toggle-sound" type="button">Play / Pause Music</button>

      <label>Volume:
        <input id="vol" type="range" min="0" max="1" step="0.01" value="0.5" />
        <span id="volVal">0.50</span>
      </label>
    </div>

    <!-- Lock gestures on mobile, but don't block controls -->
    <script>
      // Helper: event started inside the controls bar?
      function inControls(e) {
        const t = e.target;
        return t && typeof t.closest === 'function' && t.closest('.controls');
      }

      // Prevent page panning/scrolling (except over controls)
      document.addEventListener('touchmove', (e) => {
        if (inControls(e)) return;   // let slider & button work
        e.preventDefault();
      }, { passive: false });

      // Prevent pinch zoom
      document.addEventListener('gesturestart', (e) => e.preventDefault(), { passive: false });
      document.addEventListener('gesturechange', (e) => e.preventDefault(), { passive: false });
      document.addEventListener('gestureend', (e) => e.preventDefault(), { passive: false });

      // Prevent double-tap zoom (but allow taps on controls)
      let lastTouchEnd = 0;
      document.addEventListener('touchend', (e) => {
        if (inControls(e)) return;
        const now = Date.now();
        if (now - lastTouchEnd <= 300) e.preventDefault();
        lastTouchEnd = now;
      }, { passive: false });
    </script>
  </body>
</html>
